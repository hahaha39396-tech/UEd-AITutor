{% extends "base.html" %} {% block title %}Dashboard - UEd AiTutor{% endblock %} {% block page_title %}Dashboard{% endblock %} {% block content %}
<div class="dashboard-container">
    {% if current_user.role == 'student' %}
    <!-- Student Dashboard -->
    <div class="stats-grid mb-6">
        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>Kh√≥a h·ªçc ƒëang theo h·ªçc</h3>
                    <p>{{ courses|length }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--primary-100); color: var(--primary-600);">
                    üìö
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>B√†i t·∫≠p s·∫Øp h·∫øt h·∫°n</h3>
                    <p>{{ upcoming_assignments|length }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--warning-100); color: var(--warning-600);">
                    ‚è∞
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>B√†i ƒë√£ n·ªôp g·∫ßn ƒë√¢y</h3>
                    <p>{{ recent_submissions|length }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--success-100); color: var(--success-600);">
                    ‚úÖ
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card mb-6">
        <div class="card-header">
            <h2 class="card-title">Thao t√°c nhanh</h2>
        </div>
        <div class="card-body">
            <div class="flex gap-4">
                <a href="{{ url_for('assignments') }}" class="btn btn-primary">
                    <span>üìù</span> Xem b√†i t·∫≠p
                </a>
                <a href="{{ url_for('practice') }}" class="btn btn-outline">
                    <span>üèãÔ∏è</span> Luy·ªán t·∫≠p
                </a>
                <a href="{{ url_for('results') }}" class="btn btn-outline">
                    <span>üìà</span> Xem ƒëi·ªÉm s·ªë
                </a>
            </div>
        </div>
    </div>

    <!-- Upcoming Assignments -->
    {% if upcoming_assignments %}
    <div class="card mb-6">
        <div class="card-header">
            <h2 class="card-title">B√†i t·∫≠p s·∫Øp h·∫øt h·∫°n</h2>
        </div>
        <div class="card-body">
            <div class="assignment-grid">
                {% for assignment in upcoming_assignments[:3] %}
                <div class="assignment-card">
                    <div class="assignment-header">
                        <h3 class="assignment-title">{{ assignment.title }}</h3>
                        <div class="assignment-meta">
                            <span class="badge badge-{{ 'error' if assignment.due_date < moment().add(1, 'day') else 'warning' }}">
                                    H·∫øt h·∫°n: {{ assignment.due_date.strftime('%d/%m/%Y %H:%M') if assignment.due_date else 'Kh√¥ng gi·ªõi h·∫°n' }}
                                </span>
                        </div>
                    </div>
                    <div class="assignment-body">
                        <p class="assignment-description">{{ assignment.description[:100] }}...</p>
                        <div class="assignment-tags">
                            <span class="badge badge-primary">{{ assignment.language|title }}</span>
                            <span class="badge badge-secondary">{{ assignment.difficulty_level|title }}</span>
                        </div>
                    </div>
                    <div class="assignment-footer">
                        <span class="text-sm">{{ assignment.points_possible }} ƒëi·ªÉm</span>
                        <a href="#" class="btn btn-primary btn-sm">B·∫Øt ƒë·∫ßu</a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Recent Submissions -->
    {% if recent_submissions %}
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">B√†i n·ªôp g·∫ßn ƒë√¢y</h2>
        </div>
        <div class="card-body">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>B√†i t·∫≠p</th>
                            <th>ƒêi·ªÉm s·ªë</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Th·ªùi gian n·ªôp</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for submission in recent_submissions %}
                        <tr>
                            <td>{{ submission.assignment.title }}</td>
                            <td>
                                {% if submission.score is not none %} {{ "%.1f"|format(submission.score) }}/{{ submission.max_score or submission.assignment.points_possible }} {% else %} - {% endif %}
                            </td>
                            <td>
                                {% if submission.status == 'completed' %}
                                <span class="badge badge-success">Ho√†n th√†nh</span> {% elif submission.status == 'grading' %}
                                <span class="badge badge-warning">ƒêang ch·∫•m</span> {% elif submission.status == 'error' %}
                                <span class="badge badge-error">L·ªói</span> {% else %}
                                <span class="badge badge-secondary">{{ submission.status }}</span> {% endif %}
                            </td>
                            <td>{{ submission.submission_time.strftime('%d/%m/%Y %H:%M') }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %} {% elif current_user.is_instructor() %}
    <!-- Instructor Dashboard -->
    <div class="stats-grid mb-6">
        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>Kh√≥a h·ªçc ƒëang d·∫°y</h3>
                    <p>{{ courses|length }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--primary-100); color: var(--primary-600);">
                    üéì
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>B√†i n·ªôp ch·ªù ch·∫•m</h3>
                    <p>{{ recent_submissions|length }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--warning-100); color: var(--warning-600);">
                    üìã
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>B√†i t·∫≠p ƒë√£ t·∫°o</h3>
                    <p>{{ courses|sum(attribute='assignments')|length if courses else 0 }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--success-100); color: var(--success-600);">
                    üìù
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card mb-6">
        <div class="card-header">
            <h2 class="card-title">Thao t√°c nhanh</h2>
        </div>
        <div class="card-body">
            <div class="flex gap-4">
                <a href="#" class="btn btn-primary">
                    <span>‚ûï</span> T·∫°o b√†i t·∫≠p m·ªõi
                </a>
                <a href="{{ url_for('assignments') }}" class="btn btn-outline">
                    <span>üìù</span> Qu·∫£n l√Ω b√†i t·∫≠p
                </a>
                <a href="{{ url_for('results') }}" class="btn btn-outline">
                    <span>üìä</span> Xem th·ªëng k√™
                </a>
            </div>
        </div>
    </div>

    <!-- Recent Submissions -->
    {% if recent_submissions %}
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">B√†i n·ªôp g·∫ßn ƒë√¢y</h2>
        </div>
        <div class="card-body">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>H·ªçc sinh</th>
                            <th>B√†i t·∫≠p</th>
                            <th>ƒêi·ªÉm s·ªë</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Th·ªùi gian n·ªôp</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for submission in recent_submissions %}
                        <tr>
                            <td>{{ submission.user.display_name or submission.user.full_name }}</td>
                            <td>{{ submission.assignment.title }}</td>
                            <td>
                                {% if submission.score is not none %} {{ "%.1f"|format(submission.score) }}/{{ submission.max_score or submission.assignment.points_possible }} {% else %} - {% endif %}
                            </td>
                            <td>
                                {% if submission.status == 'completed' %}
                                <span class="badge badge-success">Ho√†n th√†nh</span> {% elif submission.status == 'grading' %}
                                <span class="badge badge-warning">ƒêang ch·∫•m</span> {% elif submission.status == 'error' %}
                                <span class="badge badge-error">L·ªói</span> {% else %}
                                <span class="badge badge-secondary">{{ submission.status }}</span> {% endif %}
                            </td>
                            <td>{{ submission.submission_time.strftime('%d/%m/%Y %H:%M') }}</td>
                            <td>
                                <a href="#" class="btn btn-sm btn-outline">Xem chi ti·∫øt</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %} {% else %}
    <!-- Admin Dashboard -->
    <div class="stats-grid mb-6">
        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>T·ªïng s·ªë ng∆∞·ªùi d√πng</h3>
                    <p>{{ total_users }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--primary-100); color: var(--primary-600);">
                    üë•
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>T·ªïng s·ªë kh√≥a h·ªçc</h3>
                    <p>{{ total_courses }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--success-100); color: var(--success-600);">
                    üìö
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>T·ªïng s·ªë b√†i t·∫≠p</h3>
                    <p>{{ total_assignments }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--warning-100); color: var(--warning-600);">
                    üìù
                </div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-card-content">
                <div class="stat-card-info">
                    <h3>T·ªïng s·ªë b√†i n·ªôp</h3>
                    <p>{{ total_submissions }}</p>
                </div>
                <div class="stat-card-icon" style="background-color: var(--purple-100); color: var(--purple-600);">
                    üìä
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card mb-6">
        <div class="card-header">
            <h2 class="card-title">Thao t√°c qu·∫£n tr·ªã</h2>
        </div>
        <div class="card-body">
            <div class="flex gap-4">
                <a href="#" class="btn btn-primary">
                    <span>üë§</span> Qu·∫£n l√Ω ng∆∞·ªùi d√πng
                </a>
                <a href="#" class="btn btn-outline">
                    <span>üéì</span> Qu·∫£n l√Ω kh√≥a h·ªçc
                </a>
                <a href="#" class="btn btn-outline">
                    <span>‚öôÔ∏è</span> C√†i ƒë·∫∑t h·ªá th·ªëng
                </a>
                <a href="#" class="btn btn-outline">
                    <span>üìä</span> B√°o c√°o th·ªëng k√™
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}